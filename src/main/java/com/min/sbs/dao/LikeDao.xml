<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.min.sbs.dao.LikeDao">
	
	<insert id="doAddArticleLike">
		INSERT INTO reactionPoint
		SET relId = #{id},
		relTypeCode = "article",
		`point` = 1,
		regDate = NOW(),
		updateDate = NOW(),
		memberId = #{actorId}
		
	</insert>
	
	<update id="doArticleLike">
		UPDATE reactionPoint
		SET `point` = 1,
		updateDate = NOW()
		WHERE memberId = #{actorId}
		AND relId = #{id}
	</update>
	
	<update id="doCancelArticleLike">
		update reactionPoint
		SET point = 0,
		updateDate = NOW()
		WHERE memberId = #{actorId}
		AND relId = #{id}
	</update>
	
	<select id="getIsLikeArticle" resultType="Like">
		SELECT * FROM reactionPoint
		WHERE  relTypeCode = "article"
		AND memberId=#{actorId}
		AND relId=#{id}
	</select>
	
	<select id="getLikeCount" resultType="int">
		SELECT IFNULL(SUM(`point`), 0) AS cnt
		FROM reactionPoint
		WHERE relId = #{id}
	</select>
	

</mapper>